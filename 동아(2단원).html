<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>물리학 I 기말고사 대비 (2/2)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f0f4f8; }
        .quiz-container { max-width: 800px; margin: 2rem auto; padding: 1.5rem; background-color: white; border-radius: 12px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); }
        .question-card { background-color: #ffffff; border: 1px solid #e2e8f0; border-radius: 8px; padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); }
        .question-text { font-size: 1.1rem; font-weight: 500; color: #2d3748; margin-bottom: 1rem; line-height: 1.6; }
        .question-text .blank-emphasis { font-weight: bold; color: #3b82f6; }
        .option-label { display: block; padding: 0.75rem 1rem; margin-bottom: 0.5rem; border: 1px solid #cbd5e0; border-radius: 6px; cursor: pointer; transition: background-color 0.2s, border-color 0.2s; background-color: #f7fafc; }
        .option-label:hover { background-color: #e2e8f0; }
        .option-input:checked + .option-label { background-color: #4299e1; color: white; border-color: #2b6cb0; }
        .feedback { margin-top: 1rem; padding: 0.75rem; border-radius: 6px; font-size: 0.95rem; }
        .feedback.correct { background-color: #c6f6d5; color: #2f855a; border: 1px solid #9ae6b4; }
        .feedback.incorrect { background-color: #fed7d7; color: #c53030; border: 1px solid #fbb6ce; }
        .explanation { margin-top: 0.5rem; font-size: 0.9rem; color: #4a5568; line-height: 1.5; }
        .action-button { background-color: #4a5568; color: white; padding: 0.6rem 1.2rem; border-radius: 6px; font-weight: 500; cursor: pointer; transition: background-color 0.2s; border: none; margin-top: 1rem; margin-right: 0.5rem; }
        .action-button:hover:not(:disabled) { background-color: #2d3748; }
        .action-button:disabled { background-color: #a0aec0; cursor: not-allowed; }
        .pagination-controls { display: flex; justify-content: center; align-items: center; margin-top: 2rem; margin-bottom: 1rem; flex-wrap: wrap;}
        .pagination-controls button, .pagination-controls span { margin: 0.25rem; padding: 0.5rem 0.75rem; border: 1px solid #cbd5e0; border-radius: 4px; background-color: #fff; cursor: pointer; }
        .pagination-controls button:disabled { background-color: #e2e8f0; cursor: not-allowed; opacity: 0.7; }
        .pagination-controls .page-number.current { background-color: #4299e1; color: white; border-color: #2b6cb0; font-weight: bold; }
        .score-section { margin-top: 1.5rem; padding: 1.5rem; background-color: #e9f5ff; border-radius: 8px; text-align: left; }
        .score-text { font-size: 1.1rem; font-weight: 500; color: #1a202c; margin-bottom: 0.5rem; }
        .quiz-title-in-score { font-size: 1.1rem; font-weight: bold; color: #1e40af; margin-bottom: 0.75rem; }
        .motivational-quote { font-size: 1rem; font-style: italic; color: #374151; margin-top: 1.5rem; padding-top: 1rem; border-top: 1px dashed #cbd5e0; text-align: center; }
        h1 { font-size: 1.8rem; font-weight: 700; color: #1a202c; text-align: center; margin-bottom: 1.5rem; }
        .page-info { text-align: center; margin-bottom: 1rem; font-size: 0.9rem; color: #4a5568; }
        .popup-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); display: flex; justify-content: center; align-items: center; z-index: 1000; opacity: 0; visibility: hidden; transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out; }
        .popup-overlay.show { opacity: 1; visibility: visible; }
        .popup-content { background-color: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25); text-align: center; max-width: 420px; width: 90%; }
        .popup-content h2 { font-size: 1.75rem; font-weight: 700; color: #1a202c; margin-bottom: 1rem; }
        .popup-content p.welcome-message { font-size: 1rem; color: #4a5568; margin-bottom: 1.5rem; line-height: 1.6; }
        .popup-password-input { width: 100%; padding: 0.75rem; margin-bottom: 1rem; border: 1px solid #cbd5e0; border-radius: 6px; font-size: 1rem; box-sizing: border-box; }
        .popup-confirm-btn { background-color: #3b82f6; color: white; padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 500; cursor: pointer; transition: background-color 0.2s; border: none; width: 100%; font-size: 1rem; }
        .popup-confirm-btn:hover { background-color: #2563eb; }
        .popup-error-message { color: #ef4444; font-size: 0.875rem; margin-top: 0.75rem; min-height: 1.25rem; }
    </style>
</head>
<body>
    <div id="welcome-popup" class="popup-overlay">
        <div class="popup-content">
            <h2>아피아 과학학원 UT</h2>
            <p class="welcome-message">유선종 선생님의 학습 자료입니다.<br>비밀번호를 입력해주세요.</p>
            <input type="password" id="popup-password" class="popup-password-input" placeholder="비밀번호">
            <button id="popup-confirm" class="popup-confirm-btn">확인</button>
            <p id="popup-error" class="popup-error-message"></p>
        </div>
    </div>
    <div class="quiz-container">
        <h1>물리학 I 기말고사 대비 (2/2)</h1>
        <div class="page-info" id="page-info"></div>
        <div id="quiz">
            </div>
        <div class="pagination-controls" id="pagination-controls">
            </div>
        <button id="submit-page-btn" class="action-button w-full sm:w-auto mx-auto block">이번 페이지 채점하기</button>
        <div class="score-section" id="score-section" style="display: none;">
            <p class="score-text quiz-title-in-score" id="quiz-main-title-in-score"></p>
            <p class="score-text" id="current-page-score-text"></p>
            <p class="score-text" id="total-score-text"></p>
            <p class="motivational-quote" id="motivational-quote" style="display: none;"></p>
        </div>
    </div>

    <script>
        const questions = [
            { id: 130, 'type': 'fill-in', 'text': '130. 소리와 같이 어느 한 점에서 발생한 진동이 퍼져 나가는 것을 ( )이라한다.', 'answer': '파동', 'options': ['입자', '파동', '에너지', '매질'], 'explanation': '파동은 에너지가 매질의 진동을 통해 공간으로 퍼져나가는 현상입니다.'},
            { id: 131, 'type': 'ox', 'text': '131. 파동이 에너지를 전달할 때 물질도 이동한다.', 'answer': 'X', 'options': ['O', 'X'], 'explanation': '아닙니다. 파동은 에너지만 전달하며, 매질 자체는 제자리에서 진동만 할 뿐 이동하지 않습니다.'},
            { id: 132, 'type': 'fill-in', 'text': '132. 파동이 진행할 때 ( )은 제자리에서 진동만한다.', 'answer': '매질', 'options': ['파원', '파동', '에너지', '매질'], 'explanation': '파동을 전달하는 물질인 매질은 파동과 함께 이동하지 않습니다.'},
            { id: 133, 'type': 'ox', 'text': '133. 바람이 불 때는 공기 입자가 직접 이동한다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 바람은 공기 덩어리(물질) 자체가 이동하는 것이므로, 파동과는 다릅니다.'},
            { id: 134, 'type': 'ox', 'text': '134. 소리가 전달될 때는 공기 입자가 진동하는 에너지만 이동한다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 소리는 공기라는 매질의 진동이 퍼져나가는 파동이므로, 공기 입자가 직접 귀까지 오는 것이 아닙니다.'},
            { id: 135, 'type': 'ox', 'text': '135. 모든 파동은 매질이 필요하다.', 'answer': 'X', 'options': ['O', 'X'], 'explanation': '아닙니다. 빛, 전파와 같은 전자기파는 매질이 없는 진공 속에서도 진행할 수 있습니다.'},
            { id: 136, 'type': 'fill-in', 'text': '136. 매질의 진동 방향과 파동의 진행 방향이 수직인 것은 ( )', 'answer': '횡파', 'options': ['횡파', '종파', '탄성파', '비탄성파'], 'explanation': '횡파의 예로는 빛, 전자기파, 지진의 S파 등이 있습니다.'},
            { id: 137, 'type': 'fill-in', 'text': '137. 매질의 진동 방향과 파동의 진행 방향이 나란한 것은 ( )', 'answer': '종파', 'options': ['횡파', '종파', '표면파', '전자기파'], 'explanation': '종파의 예로는 소리, 초음파, 지진의 P파 등이 있습니다.'},
            { id: 138, 'type': 'fill-in', 'text': '138. 진동수의 단위는 ( )를 쓴다.', 'answer': 'Hz', 'options': ['s', 'm', 'Hz', 'm/s'], 'explanation': '진동수는 1초 동안 진동하는 횟수를 나타내며, 단위로 헤르츠(Hz)를 사용합니다.'},
            { id: 139, 'type': 'fill-in', 'text': '139. 매질이 진동하는 최대 변위를 ( )이라한다.', 'answer': '진폭', 'options': ['파장', '주기', '진폭', '진동수'], 'explanation': '진폭은 진동의 중심에서부터 마루 또는 골까지의 거리를 의미하며, 파동의 에너지와 관련이 있습니다.'},
            { id: 140, 'type': 'ox', 'text': '140. 진폭은 파동의 마루부터 골까지의 폭이다.', 'answer': 'X', 'options': ['O', 'X'], 'explanation': '아닙니다. 진폭은 진동 중심에서 마루(또는 골)까지의 거리입니다. 마루에서 골까지의 거리는 진폭의 2배입니다.'},
            { id: 141, 'type': 'ox', 'text': '141. 진폭은 파동의 중심부터 마루 또는 골까지의 폭이다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 이것이 진폭의 정확한 정의입니다.'},
            { id: 142, 'type': 'fill-in', 'text': '142. 파동의 속력은 느슨한줄이 팽팽한 줄보다 ( )', 'answer': '느리다', 'options': ['빠르다', '느리다', '같다', '알수없다'], 'explanation': '매질이 팽팽할수록 진동이 더 빨리 전달되므로 파동의 속력이 더 빠릅니다.'},
            { id: 143, 'type': 'ox', 'text': '143. 소리는 고체에서 가장 빠르다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 소리는 매질의 밀도가 높을수록(고체>액체>기체 순) 더 빠르게 전달됩니다.'},
            { id: 144, 'type': 'ox', 'text': '144. 파동의 속력은 매질에만 영향을 받는다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 매질이 바뀌지 않는 한, 파동의 속력은 일정합니다. 진동수나 파장이 변해도 속력은 변하지 않습니다.'},
            { id: 145, 'type': 'fill-in', 'text': '145. 매질이 그대로인 상태에서 진동수가 2배 커지면 파장은 ( )배', 'answer': '1/2', 'options': ['2', '1/2', '4', '1/4'], 'explanation': '파동의 속력(v) = 진동수(f) × 파장(λ) 관계에서 속력(v)이 일정하므로, 진동수가 2배가 되면 파장은 1/2배가 되어야 합니다.'},
            { id: 146, 'type': 'fill-in', 'text': '146. 매질이 그대로인 상태에서 주기가 2배 커지면 파장은 ( )배', 'answer': '2', 'options': ['2', '1/2', '4', '1/4'], 'explanation': '주기와 진동수는 역수 관계(T=1/f)입니다. 주기가 2배가 되면 진동수는 1/2배가 되고, 파장은 2배가 됩니다.'},
            { id: 147, 'type': 'ox', 'text': '147. 파동이 진행할 때 매질이 변하면 속력이 변한다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 파동의 속력은 오직 매질의 특성에 의해서만 결정됩니다.'},
            { id: 148, 'type': 'ox', 'text': '148. 파동이 진행할 때 매질이 변하면 주기가 변한다.', 'answer': 'X', 'options': ['O', 'X'], 'explanation': '아닙니다. 주기와 진동수는 파동을 발생시키는 파원에서 결정되므로, 매질이 변해도 변하지 않습니다.'},
            { id: 149, 'type': 'ox', 'text': '149. 파동이 진행할 때 매질이 변하면 진동수가 변한다.', 'answer': 'X', 'options': ['O', 'X'], 'explanation': '아닙니다. 진동수와 주기는 파원에서 결정되며, 매질이 변해도 일정하게 유지됩니다.'},
            { id: 150, 'type': 'ox', 'text': '150. 파동이 진행할 때 매질이 변하면 파장이 변한다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 속력(v)=진동수(f)×파장(λ)에서, 진동수(f)는 일정한데 속력(v)이 변하므로 파장(λ)이 변해야 합니다.'},
            { id: 151, 'type': 'ox', 'text': '151. "종소리가 잘 들리면 비가 온다"라는 말은 굴절 때문이다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 습도가 높으면 소리의 속력이 빨라져, 위쪽보다 아래쪽 공기에서 소리가 더 빨리 진행하면서 소리가 아래로 휘어(굴절) 멀리까지 들리게 됩니다.'},
            { id: 152, 'type': 'fill-in', 'text': '152. 비가 오기전 지표면 근처의 공기와 위쪽의 공기의 온도 차이는 ( )다.', 'answer': '작', 'options': ['크', '작', '상관없', '매우크'], 'explanation': '비가 오기 전에는 흐린 날씨로 인해 지표면과 상공의 온도 차이가 작아져, 소리가 굴절하기 좋은 조건이 됩니다.'},
            { id: 153, 'type': 'ox', 'text': '153. 주스가 담긴 유리병을 유리와 굴절률이 비슷한 글리세린을 넣어주면 빛은 거의 굴절하지 않는다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 두 매질의 굴절률이 비슷하면 빛이 거의 꺾이지 않고 직진하므로 유리병이 보이지 않게 될 수 있습니다.'},
            { id: 154, 'type': 'fill-in', 'text': '154. 절대 굴절률은 빛이 ( )에서 매질로 진행할 때 굴절한 정도이다.', 'answer': '진공', 'options': ['물', '공기', '진공', '유리'], 'explanation': '진공에서의 빛의 속력에 대한 매질에서의 빛의 속력의 비로 정의됩니다.'},
            { id: 155, 'type': 'ox', 'text': '155. 굴절률이 클수록 해당 매질에서 파동의 속력은 빠르다.', 'answer': 'X', 'options': ['O', 'X'], 'explanation': '아닙니다. 굴절률이 클수록 빛이 더 많이 꺾인다는 의미이며, 해당 매질에서의 속력은 더 느립니다.'},
            { id: 156, 'type': 'fill-in', 'text': '156. n₁₂는 빛이 ( )번 매질에서 ( )번 매질로 진행할 때의 상대굴절률이다.', 'answer': '1;2', 'options': ['1;2', '2;1', '1;1', '2;2'], 'explanation': '첨자의 순서대로, 매질 1에 대한 매질 2의 상대 굴절률을 의미합니다.'},
            { id: 157, 'type': 'ox', 'text': '157. 법선과 나란하게 입사한 파동은 굴절하지 않는다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 입사각이 0°일 경우, 굴절각도 0°가 되어 꺾이지 않고 그대로 직진합니다.'},
            { id: 158, 'type': 'fill-in', 'text': '158. 망원경, 현미경, 사진기는 빛의 ( )을 활용한 예이다.', 'answer': '굴절', 'options': ['반사', '굴절', '간섭', '회절'], 'explanation': '이 기구들은 모두 렌즈를 이용하여 빛을 굴절시켜 상을 확대하거나 맺히게 하는 원리를 이용합니다.'},
            { id: 159, 'type': 'fill-in', 'text': '159. 굴절각이 90° 일때의 입사각을 ( )이라한다.', 'answer': '임계각', 'options': ['반사각', '입사각', '임계각', '전반사각'], 'explanation': '전반사가 일어나기 시작하는 경계가 되는 입사각을 임계각이라고 합니다.'},
            { id: 160, 'type': 'fill-in', 'text': '160. 전반사의 조건에는 ( ), 입사각이 임계각보다 ( )다.', 'answer': '느빠;크', 'options': ['빠느;작', '느빠;크', '빠느;크', '느빠;작'], 'explanation': '전반사는 빛이 굴절률이 큰(속력이 느린) 매질에서 굴절률이 작은(속력이 빠른) 매질로 진행할 때, 입사각이 임계각보다 클 경우에만 일어납니다.'},
            { id: 161, 'type': 'ox', 'text': '161. 빛이 매질 1에서 2로 진행할 때, n₁>n₂ 라면 전반사는 일어날 수 있다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 굴절률이 큰 매질(n₁)에서 작은 매질(n₂)로 진행하는 조건이므로 전반사가 가능합니다.'},
            { id: 162, 'type': 'ox', 'text': '162. 빛이 매질 1에서 2로 진행할 때, n₁<n₂ 라면 전반사는 일어날 수 없다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 굴절률이 작은 매질에서 큰 매질로 진행할 때는 전반사가 일어나지 않습니다.'},
            { id: 163, 'type': 'fill-in', 'text': '163. 빛이 매질 1에서 2로 진행할 때 임계각을 구하는 식은 sin(ic) = ( )이다.', 'answer': 'n₂/n₁', 'options': ['n₁/n₂', 'n₂/n₁', 'n₁·n₂', 'n₁-n₂'], 'explanation': '스넬의 법칙(n₁sin(i)=n₂sin(r))에서 굴절각(r)이 90°일 때의 입사각(i)이 임계각(ic)이므로, sin(ic) = n₂/n₁ 입니다.'},
            { id: 164, 'type': 'ox', 'text': '164. 유리의 임계각은 약 42°로 입사각이 45° 라면 전반사가 일어난다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 입사각(45°)이 임계각(42°)보다 크므로 전반사 조건이 충족됩니다.'},
            { id: 165, 'type': 'fill-in', 'text': '165. 다이아몬드가 반짝거리는 이유는 내부에서 ( )가 일어나기 때문이다.', 'answer': '전반사', 'options': ['굴절', '분산', '전반사', '회절'], 'explanation': '다이아몬드는 굴절률이 매우 커서 임계각이 작습니다. 따라서 내부로 들어간 빛이 대부분 전반사되어 밖으로 나오지 못하고 내부에서 여러 번 반사되어 반짝거립니다.'},
            { id: 166, 'type': 'ox', 'text': '166. 거울은 전반사를 한다.', 'answer': 'X', 'options': ['O', 'X'], 'explanation': '아닙니다. 거울은 빛의 반사를 이용하는 것이지, 전반사와는 원리가 다릅니다.'},
            { id: 167, 'type': 'ox', 'text': '167. 광섬유는 주로 유리로 만든다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 매우 순도가 높은 석영 유리로 만들어 빛의 손실을 최소화합니다.'},
            { id: 168, 'type': 'fill-in', 'text': '168. 광통신은 크게 ( )와 ( ), 광섬유로 이루어진다.', 'answer': '송신기;수신기', 'options': ['송신기;수신기', '레이저;광센서', '발광다이오드;광다이오드', '증폭기;감쇠기'], 'explanation': '송신기에서 전기 신호를 빛 신호로 바꾸고, 광섬유를 통해 빛 신호를 전달하며, 수신기에서 다시 빛 신호를 전기 신호로 바꿉니다.'},
            { id: 169, 'type': 'fill-in', 'text': '169. 송신기에서는 ( )신호를 ( )신호로 전환한다.', 'answer': '전기;빛', 'options': ['빛;전기', '전기;빛', '소리;빛', '빛;소리'], 'explanation': '전기 신호를 레이저나 LED를 이용해 빛 신호로 변환하여 광섬유로 보냅니다.'},
            { id: 170, 'type': 'fill-in', 'text': '170. 수신기에서는 ( )신호를 ( )신호로 전환한다.', 'answer': '빛;전기', 'options': ['빛;전기', '전기;빛', '소리;빛', '빛;소리'], 'explanation': '광섬유를 통해 온 빛 신호를 광다이오드 등을 이용해 다시 전기 신호로 변환합니다.'},
            { id: 171, 'type': 'ox', 'text': '171. 광섬유를 이용한 통신은 보다 많은 정보를 멀리 보낼 수 있다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 광섬유는 대역폭이 넓어 많은 정보를 실을 수 있고, 에너지 손실이 적어 증폭 없이도 매우 멀리 신호를 보낼 수 있습니다.'},
            { id: 172, 'type': 'ox', 'text': '172. 광섬유를 이용한 통신은 비용이 많이 들고 연결 부에 먼지가 끼거나 틈이 생기면 통신이 불가능해진다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 설치 비용이 비싸고, 한번 끊어지면 수리가 어려우며, 연결부에 이물질이 끼면 신호 손실이 크다는 단점이 있습니다.'},
            { id: 173, 'type': 'fill-in', 'text': '173. 광섬유를 따라 빛이 전반사되기 위해서 코어의 굴절률은 클래딩의 굴절률보다 ( ).', 'answer': '커야한다', 'options': ['작아야한다', '커야한다', '같아야한다', '상관없다'], 'explanation': '빛이 굴절률이 큰 매질(코어)에서 작은 매질(클래딩)로 진행해야 전반사가 일어나기 때문입니다.'},
            { id: 174, 'type': 'fill-in', 'text': '174. 광섬유를 따라 빛이 전반사되기 위해서 클래딩의 굴절률은 코어의 굴절률보다 ( ).', 'answer': '작아야한다', 'options': ['작아야한다', '커야한다', '같아야한다', '상관없다'], 'explanation': '빛이 굴절률이 큰 매질(코어)에서 작은 매질(클래딩)로 진행해야 전반사가 일어나기 때문입니다.'},
            { id: 175, 'type': 'ox', 'text': '175. 광섬유는 많이 휜 상태여도 전반사가 항상 일어난다.', 'answer': 'X', 'options': ['O', 'X'], 'explanation': '아닙니다. 광섬유를 너무 많이 구부리면 빛의 입사각이 임계각보다 작아져 전반사가 일어나지 않고 빛이 외부로 새어나갈 수 있습니다.'},
            { id: 176, 'type': 'ox', 'text': '176. 초음파는 소리로 종파이다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 초음파는 사람이 들을 수 없는 높은 진동수의 소리이며, 소리는 종파에 속합니다.'},
            { id: 177, 'type': 'ox', 'text': '177. 초음파는 고체에서 가장 빠르며, 진공에서 전달되지 않는다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 소리의 일종이므로 매질이 필요하며, 매질이 빽빽한 고체에서 가장 속력이 빠릅니다.'},
            { id: 178, 'type': 'ox', 'text': '178. 진공에서 전자기파의 속력은 종류에 관계없이 같다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 모든 종류의 전자기파(라디오파, 빛, X선 등)는 진공에서 빛의 속력 c로 동일하게 진행합니다.'},
            { id: 179, 'type': 'ox', 'text': '179. 전자기파는 매질이 없어도 진행이 가능하다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 전자기파는 전기장과 자기장의 진동이 퍼져나가는 현상으로, 매질 없이도 우주 공간을 진행할 수 있습니다.'},
            { id: 180, 'type': 'ox', 'text': '180. 전자기파에서 전기장과 자기장과 진행 방향은 모두 수직이다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 이는 전자기파가 횡파임을 보여주는 중요한 특징입니다.'},
            { id: 181, 'type': 'ox', 'text': '181. 빛은 전자기파의 한 종류이다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 가시광선은 전자기파 스펙트럼의 매우 좁은 일부 영역입니다.'},
            { id: 182, 'type': 'ox', 'text': '182. 빛과 전자기파의 속력은 같다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 빛이 곧 전자기파이므로, 진공에서의 속력은 같습니다.'},
            { id: 183, 'type': 'ox', 'text': '183. 전자기파의 에너지는 파장이 길수록 크다.', 'answer': 'X', 'options': ['O', 'X'], 'explanation': '아닙니다. 전자기파의 에너지는 진동수에 비례하고 파장에는 반비례하므로, 파장이 길수록 에너지는 작습니다.'},
            { id: 184, 'type': 'fill-in', 'text': '184. 라디오파는 에너지가 가장 작기 때문에 파장은 가장 ( )고, 진동수는 가장 ( )다.', 'answer': '길;작', 'options': ['짧;크', '길;작', '길;크', '짧;작'], 'explanation': '전자기파 스펙트럼에서 라디오파는 파장이 가장 길고, 진동수가 가장 작으며, 에너지가 가장 작습니다.'},
            { id: 185, 'type': 'fill-in', 'text': '185. 감마선은 에너지가 가장 크기 때문에 파장은 가장 ( )고, 진동수는 가장 ( )다.', 'answer': '짧;크', 'options': ['짧;크', '길;작', '길;크', '짧;작'], 'explanation': '감마선은 파장이 가장 짧고, 진동수가 가장 크며, 에너지가 가장 큽니다.'},
            { id: 186, 'type': 'fill-in', 'text': '186. ( )는 전자레인지에 쓰이며 진동수가 물 분자의 진동수와 같다.', 'answer': '마이크로파', 'options': ['라디오파', '적외선', '마이크로파', '자외선'], 'explanation': '전자레인지는 마이크로파를 이용하여 물 분자를 진동시켜 음식을 데우는 원리입니다.'},
            { id: 187, 'type': 'fill-in', 'text': '187. 파장이 길수록 파동이 퍼지는 성질은 ( )지만 전자기파에 담을 수 있는 정보의 양은 ( )다.', 'answer': '좋아지;적', 'options': ['좋아지;많', '나빠지;적', '좋아지;적', '나빠지;많'], 'explanation': '파장이 길수록 회절이 잘 일어나 멀리 퍼지지만, 진동수가 낮아 단위 시간당 보낼 수 있는 정보의 양은 적습니다.'},
            { id: 188, 'type': 'ox', 'text': '188. 가시광선을 이용한 무선 통신 기술은 불가능하다.', 'answer': 'X', 'options': ['O', 'X'], 'explanation': '아닙니다. 가시광선을 이용한 라이파이(Li-Fi) 기술이 개발되어 사용되고 있습니다.'},
            { id: 189, 'type': 'fill-in', 'text': '189. ( )는 가시광선을 이용한 무선 통신 기술이다.', 'answer': '라이파이', 'options': ['와이파이', '블루투스', '라이파이', 'NFC'], 'explanation': '라이파이는 LED 조명의 깜빡임을 이용하여 데이터를 전송하는 기술입니다.'},
            { id: 190, 'type': 'fill-in', 'text': '190. 라이파이, 블루투스 중 파장이 더 긴 전자기파는 ( )', 'answer': '블루투스', 'options': ['라이파이', '블루투스', '같다', '알수없다'], 'explanation': '라이파이는 가시광선을, 블루투스는 그보다 파장이 긴 마이크로파를 사용합니다.'},
            { id: 191, 'type': 'fill-in', 'text': '191. 라이파이, 블루투스 중 진동수가 더 큰 전자기파는 ( )', 'answer': '라이파이', 'options': ['라이파이', '블루투스', '같다', '알수없다'], 'explanation': '파장이 더 짧은 가시광선을 사용하는 라이파이의 진동수가 더 큽니다.'},
            { id: 192, 'type': 'fill-in', 'text': '192. 파동은 한 지점에서 서로 겹치더라도 서로에게 영향을 미치지 않는 성질이 있는데 이를 ( )이라한다.', 'answer': '파동의 독립성', 'options': ['중첩원리', '간섭', '회절', '파동의 독립성'], 'explanation': '각 파동은 중첩 후에도 원래의 모양과 성질을 그대로 유지하며 각자의 길을 갑니다.'},
            { id: 193, 'type': 'fill-in', 'text': '193. 두 파동이 한 지점에서 겹칠 때 그 지점에서 매질의 변위는 각각의 변위를 합친 것과 같다. 이를 ( )라한다.', 'answer': '중첩원리', 'options': ['중첩원리', '간섭', '독립성', '회절'], 'explanation': '중첩 원리는 여러 파동이 만났을 때 합성파의 변위를 계산하는 기본 원리입니다.'},
            { id: 194, 'type': 'fill-in', 'text': '194. 중첩의 결과 합쳐진 파동을 ( )라 한다.', 'answer': '합성파', 'options': ['간섭파', '정상파', '합성파', '보강파'], 'explanation': '각각의 파동이 중첩되어 만들어진 새로운 모양의 파동을 합성파라고 합니다.'},
            { id: 195, 'type': 'fill-in', 'text': '195. 파동이 중첩되어 진폭이 변하는 현상을 ( )이라 한다.', 'answer': '파동의 간섭', 'options': ['회절', '굴절', '파동의 간섭', '반사'], 'explanation': '같은 위상으로 만나면 진폭이 커지고(보강 간섭), 반대 위상으로 만나면 진폭이 작아집니다(상쇄 간섭).'},
            { id: 196, 'type': 'fill-in', 'text': '196. 정상파에서 진폭이 0인 지점을 ( )라한다.', 'answer': '마디', 'options': ['배', '마디', '중심', '영점'], 'explanation': '상쇄 간섭이 지속적으로 일어나 전혀 진동하지 않는 지점을 마디(node)라고 합니다.'},
            { id: 197, 'type': 'fill-in', 'text': '197. 정상파에서 진폭이 최대인 지점을 ( )라한다.', 'answer': '배', 'options': ['배', '마디', '중심', '최대점'], 'explanation': '보강 간섭이 지속적으로 일어나 최대 진폭으로 진동하는 지점을 배(antinode)라고 합니다.'},
            { id: 198, 'type': 'fill-in', 'text': '198. 정상파에서 마디와 마디 사이 거리는 ( )이다.', 'answer': '반파장', 'options': ['반파장', '한파장', '두파장', '1/4파장'], 'explanation': '인접한 마디와 마디, 또는 배와 배 사이의 거리는 원래 파장의 절반(λ/2)입니다.'},
            { id: 199, 'type': 'fill-in', 'text': '199. 비눗방울에서 빨간색으로 보이는 부분은 윗면에서 ( )된 빨간 빛과 아랫면에서 ( )된 빨간 빛이 보강 간섭을 일으킨 것이다.', 'answer': '반사;반사', 'options': ['굴절;굴절', '반사;반사', '굴절;반사', '반사;굴절'], 'explanation': '얇은 막의 윗면과 아랫면에서 반사된 두 빛이 경로차에 의해 특정 색에서 보강 간섭을 일으켜 우리 눈에 보이게 됩니다.'},
            { id: 200, 'type': 'fill-in', 'text': '200. 비눗방울의 두께와 보는 각도에 따라 ( )가 달라져 보강 간섭 하는 빛의 색깔도 달라진다.', 'answer': '경로차', 'options': ['위상차', '속도차', '경로차', '진폭차'], 'explanation': '두께와 각도에 따라 두 반사광 사이의 경로차가 달라지고, 이에 따라 보강 간섭이 일어나는 파장(색깔)이 달라집니다.'},
            { id: 201, 'type': 'ox', 'text': '201. 모르포 나비의 날개가 푸른색을 띠는 것은 나비의 날개가 파란색이기 때문이다.', 'answer': 'X', 'options': ['O', 'X'], 'explanation': '아닙니다. 모르포 나비의 날개에는 색소가 없으며, 날개의 미세한 나노 구조에 의해 빛의 간섭이 일어나 푸른색만 반사되는 구조색입니다.'},
            { id: 202, 'type': 'fill-in', 'text': '202. 모르포 나비의 날개가 푸른색을 띠는 것은 빛의 ( ) 때문이다.', 'answer': '간섭', 'options': ['굴절', '반사', '회절', '간섭'], 'explanation': '날개 표면의 나노 구조가 특정 파장의 빛(푸른색)만 보강 간섭을 일으키도록 만듭니다.'},
            { id: 203, 'type': 'ox', 'text': '203. 간섭은 파동에서만 나타난다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 간섭과 회절은 파동만이 가지는 고유한 성질입니다.'},
            { id: 204, 'type': 'fill-in', 'text': '204. 빛의 간섭은 빛이 ( )을 가짐을 의미한다.', 'answer': '파동성', 'options': ['입자성', '파동성', '이중성', '직진성'], 'explanation': '간섭 현상은 빛이 파동의 성질을 가지고 있다는 강력한 증거입니다.'},
            { id: 205, 'type': 'fill-in', 'text': '205. 형광물질은 전자가 ( )을 받아 에너지를 흡수하여 ( )에서 ( )가 될 때 빛을 방출한다.', 'answer': '빛;들뜬 상태;바닥상태', 'options': ['빛;들뜬 상태;바닥상태', '열;바닥상태;들뜬상태', '빛;바닥상태;들뜬상태', '열;들뜬 상태;바닥상태'], 'explanation': '주로 자외선과 같은 높은 에너지의 빛을 흡수하여 들뜬 상태가 되었다가, 다시 바닥 상태로 내려오면서 가시광선 영역의 빛을 방출합니다.'},
            { id: 206, 'type': 'ox', 'text': '206. 지폐의 형광 무늬는 빛의 파동성이다.', 'answer': 'X', 'options': ['O', 'X'], 'explanation': '아닙니다. 형광 현상은 빛이 입자처럼 에너지를 덩어리로 주고받는다는 빛의 입자성을 보여주는 증거입니다.'},
            { id: 207, 'type': 'fill-in', 'text': '207. 빛을 연속적인 파동이 아니라 불연속적인 에너지 "양자"의 흐름이라고 본 이론을 ( )이라한다.', 'answer': '광양자설', 'options': ['파동설', '입자설', '광양자설', '광전효과'], 'explanation': '아인슈타인이 제안한 광양자설은 빛이 광자(광양자)라는 에너지 덩어리로 이루어져 있다고 설명합니다.'},
            { id: 208, 'type': 'fill-in', 'text': '208. 광전자의 수는 빛의 ( )에만 관계있다.', 'answer': '세기', 'options': ['세기', '진동수', '파장', '에너지'], 'explanation': '빛의 세기가 강할수록(광자의 개수가 많을수록) 튀어나오는 광전자의 수가 많아집니다.'},
            { id: 209, 'type': 'fill-in', 'text': '209. 광전자의 최대 운동 에너지는 빛의 ( )에만 관계있다.', 'answer': '진동수', 'options': ['세기', '진동수', '파장', '개수'], 'explanation': '빛의 진동수가 클수록(광자 1개의 에너지가 클수록) 튀어나오는 광전자의 운동 에너지가 커집니다.'},
            { id: 210, 'type': 'fill-in', 'text': '210. 광 다이오드의 원리는 ( )이다.', 'answer': '광전효과', 'options': ['전자기유도', '광전효과', '정류작용', '증폭작용'], 'explanation': '광다이오드는 반도체에 빛을 비추었을 때 전자가 튀어나와 전류가 흐르는 광전 효과를 이용한 소자입니다.'},
            { id: 211, 'type': 'ox', 'text': '211. 광 다이오드는 p-n 접합 다이오드와 구조가 같다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. p-n 접합 구조를 가지고 있으며, 접합면에 빛을 비출 수 있도록 창이 나 있습니다.'},
            { id: 212, 'type': 'ox', 'text': '212. 광 다이오드에서 전류가 만들어질 때 전자는 n형 반도체로 이동한다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 빛에 의해 생성된 전자-양공 쌍에서, 전자는 n형 쪽으로, 양공은 p형 쪽으로 이동하여 전류가 흐릅니다.'},
            { id: 213, 'type': 'ox', 'text': '213. 광 다이오드에서 전류가 만들어질 때 양공은 p형 반도체로 이동한다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 빛에 의해 생성된 전자-양공 쌍에서, 전자는 n형 쪽으로, 양공은 p형 쪽으로 이동하여 전류가 흐릅니다.'},
            { id: 214, 'type': 'ox', 'text': '214. p-n접합 다이오드에서 전류가 흐를 수 있을 때 양공과 전자는 접합면으로 이동한다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 이는 순방향 전압이 걸렸을 때의 상황입니다.'},
            { id: 215, 'type': 'fill-in', 'text': '215. 광 다이오드의 원리를 이용하여 디지털카메라에 쓰이는 소자를 ( )라한다.', 'answer': '전하결합소자', 'options': ['액정표시장치(LCD)', '발광다이오드(LED)', '전하결합소자(CCD)', '트랜지스터'], 'explanation': 'CCD는 수많은 광다이오드를 집적하여 빛의 세기를 전기 신호로 바꾸어 영상을 만드는 장치입니다.'},
            { id: 216, 'type': 'ox', 'text': '216. CCD는 빛을 전기신호로 바꾸는 역할을 한다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 빛의 세기에 비례하는 양의 전하를 발생시켜 전기 신호로 변환합니다.'},
            { id: 217, 'type': 'ox', 'text': '217. 같은 크기의 CCD에서 화소의 수가 많을수록 담을 수 있는 정보가 많다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 화소 수가 많다는 것은 더 세밀한 이미지를 표현할 수 있다는 의미로, 해상도가 높다고 말합니다.'},
            { id: 218, 'type': 'ox', 'text': '218. 같은 크기의 CCD에서 화소의 크기가 작을수록 담을 수 있는 정보가 많다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 같은 면적에 더 작은 화소를 더 많이 넣을 수 있으므로, 더 정밀한(고해상도) 이미지를 얻을 수 있습니다.'},
            { id: 219, 'type': 'ox', 'text': '219. 같은 크기의 CCD에서 100만 화소보다 800만 화소가 담을 수 있는 정보가 많다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 화소 수가 많을수록 더 많은 이미지 정보를 담을 수 있습니다.'},
            { id: 220, 'type': 'ox', 'text': '220. CCD는 빛의 양만 측정할 수 있고 색을 구별할 수 없다.', 'answer': 'O', 'options': ['O', 'X'], 'explanation': '맞습니다. 기본적인 CCD(광다이오드)는 빛의 세기만 감지하므로, 색을 구분하기 위해서는 별도의 장치가 필요합니다.'},
            { id: 221, 'type': 'fill-in', 'text': '221. ( )를 CCD에 붙여 색을 구분한다.', 'answer': '색필터', 'options': ['편광판', '프리즘', '색필터', '렌즈'], 'explanation': '각 화소 앞에 빨강(R), 초록(G), 파랑(B) 색 필터를 붙여, 특정 색의 빛만 통과시켜 색 정보를 얻습니다.'}
        ];
        
        // 이 아래의 코드는 이전과 동일합니다.
        const motivationalQuotes = [
            "오늘의 노력이 내일의 너를 만든다.", "포기하지 않는 한, 실패는 없다.", "가장 큰 위험은 아무 위험도 감수하지 않는 것이다.",
            "배움은 의무도, 생존도 아니다. 그것은 우리의 가장 큰 특권이다.", "성공은 최종 목적지가 아니며, 실패는 치명적이지 않다. 중요한 것은 계속 나아가는 용기다.",
            "작은 성공들이 모여 큰 성공을 이룬다.", "어제보다 나은 오늘, 오늘보다 나은 내일을 만들자.",
            "가장 큰 영광은 한 번도 실패하지 않음이 아니라 실패할 때마다 다시 일어서는 데에 있다.", "천리길도 한 걸음부터.", "노력은 결코 배신하지 않는다."
        ];

        const quizElement = document.getElementById('quiz');
        const paginationControlsElement = document.getElementById('pagination-controls');
        const submitPageButton = document.getElementById('submit-page-btn');
        const scoreSectionElement = document.getElementById('score-section');
        const currentPageScoreTextElement = document.getElementById('current-page-score-text');
        const totalScoreTextElement = document.getElementById('total-score-text');
        const pageInfoElement = document.getElementById('page-info');
        const quizMainTitleDisplayElement = document.getElementById('quiz-main-title-in-score');
        const motivationalQuoteElement = document.getElementById('motivational-quote');
        
        const welcomePopup = document.getElementById('welcome-popup');
        const popupPasswordInput = document.getElementById('popup-password');
        const popupConfirmButton = document.getElementById('popup-confirm');
        const popupErrorMessage = document.getElementById('popup-error');

        const correctPassword = "0407";

        const questionsPerPage = 10;
        let currentPage = 0;
        let pageScores = [];
        let pageAttempted = [];

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function initializeQuizData() {
            questions.forEach(q => {
                q.userAnswer = null;
                q.isCorrect = null;
                q.attemptedThisSession = false;
                if (q.answer && q.answer.includes(';')) {
                    q.answersArray = q.answer.split(';');
                } else if (q.answer) {
                    q.answersArray = [q.answer];
                } else {
                    q.answersArray = [];
                }
                if (q.type !== 'ox') {
                   shuffleArray(q.options);
                }
            });
            const numPages = Math.ceil(questions.length / questionsPerPage);
            pageAttempted = new Array(numPages).fill(false);
            pageScores = new Array(numPages).fill(0);
        }

        function renderQuestionsForPage(page) {
            quizElement.innerHTML = '';
            currentPage = page;

            const start = page * questionsPerPage;
            const end = Math.min(start + questionsPerPage, questions.length);
            const questionsOnPage = questions.slice(start, end);

            pageInfoElement.textContent = `총 ${questions.length}문제 중 ${start + 1} - ${end}번 문제`;

            questionsOnPage.forEach((q, indexOnPage) => {
                const questionCard = document.createElement('div');
                questionCard.classList.add('question-card');
                questionCard.id = `question-${q.id}`;

                const questionText = document.createElement('p');
                questionText.classList.add('question-text');
                let processedText = q.text.replace(/\d+\.\s*/, (match) => `<span class="font-bold">${match}</span>`);
                
                processedText = processedText.replace(/(\(\s*\))/g, '<span class="blank-emphasis">( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; )</span>');
                
                // Handle multiple blanks
                let blankIndex = 0;
                processedText = processedText.replace(/<span class="blank-emphasis">\( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \)<\/span>/g, () => {
                    if (q.answersArray && q.answersArray.length > 1 && q.answersArray[blankIndex]) {
                        const blankText = `( ${"&nbsp;".repeat(q.answersArray[blankIndex].length * 2)} )`;
                        blankIndex++;
                        return `<span class="blank-emphasis">${blankText}</span>`;
                    }
                    return '<span class="blank-emphasis">( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; )</span>';
                });

                questionText.innerHTML = processedText.replace(/(\d+)/g, '<sub>$1</sub>').replace(/<sub>(\d{2,})<\/sub>/g, '$1').replace(/×10⁸/g, '×10<sup>8</sup>');
                questionCard.appendChild(questionText);

                const optionsContainer = document.createElement('div');
                optionsContainer.classList.add('options');

                q.options.forEach((option, index) => {
                    const optionId = `q${q.id}-option-${index}`;
                    
                    const radioInput = document.createElement('input');
                    radioInput.type = 'radio';
                    radioInput.id = optionId;
                    radioInput.name = `question-${q.id}`;
                    radioInput.value = option;
                    radioInput.classList.add('option-input', 'hidden');
                    if (q.userAnswer === option) radioInput.checked = true;
                    if (pageAttempted[currentPage]) radioInput.disabled = true;

                    const optionLabel = document.createElement('label');
                    optionLabel.htmlFor = optionId;
                    optionLabel.innerHTML = option.includes(';') ? option.split(';').join(', ') : option.replace(/(\d+)/g, '<sub>$1</sub>').replace(/<sub>(\d{2,})<\/sub>/g, '$1').replace(/×10⁸/g, '×10<sup>8</sup>');
                    optionLabel.classList.add('option-label');
                    if (pageAttempted[currentPage]) optionLabel.classList.add('opacity-70', 'cursor-not-allowed');

                    optionsContainer.appendChild(radioInput);
                    optionsContainer.appendChild(optionLabel);
                });
                questionCard.appendChild(optionsContainer);

                const feedbackElement = document.createElement('div');
                feedbackElement.classList.add('feedback');
                feedbackElement.style.display = 'none';
                questionCard.appendChild(feedbackElement);
                
                if (pageAttempted[currentPage] && q.attemptedThisSession) {
                    showFeedbackForQuestion(q, questionCard);
                }
                quizElement.appendChild(questionCard);
            });

            const numPages = Math.ceil(questions.length / questionsPerPage);
            if (numPages > 1) {
                paginationControlsElement.style.display = 'flex';
                renderPaginationControls();
            } else {
                paginationControlsElement.style.display = 'none';
            }

            submitPageButton.disabled = pageAttempted[currentPage];
            if (pageAttempted[currentPage]) {
                submitPageButton.textContent = '채점 완료';
                scoreSectionElement.style.display = 'block';
                updateScoreDisplay();
                showMotivationalQuote();
            } else {
                submitPageButton.textContent = '이번 페이지 채점하기';
                motivationalQuoteElement.style.display = 'none';
                if (questionsOnPage.length > 0) {
                    scoreSectionElement.style.display = 'none';
                } else {
                    scoreSectionElement.style.display = 'block';
                    currentPageScoreTextElement.textContent = '이번 페이지에 문제가 없습니다.';
                    totalScoreTextElement.textContent = '';
                }
            }
        }
        
        function showFeedbackForQuestion(question, questionCard) {
            const feedbackElement = questionCard.querySelector('.feedback');
            if (!feedbackElement) return;

            feedbackElement.innerHTML = '';
            const correctAnswerText = question.answersArray.join(', ');

            if (question.isCorrect) {
                feedbackElement.innerHTML = '<strong class="font-semibold">정답입니다!</strong> 🎉';
                feedbackElement.className = 'feedback correct';
            } else {
                feedbackElement.innerHTML = `<strong class="font-semibold">오답입니다.</strong> 정답은 "<span class="font-bold text-red-700">${correctAnswerText.replace(/(\d+)/g, '<sub>$1</sub>').replace(/<sub>(\d{2,})<\/sub>/g, '$1').replace(/×10⁸/g, '×10<sup>8</sup>')}</span>"입니다.`;
                feedbackElement.className = 'feedback incorrect';
            }

            const explanationElement = document.createElement('p');
            explanationElement.classList.add('explanation');
            explanationElement.innerHTML = `<strong class="font-semibold">해설:</strong> ${question.explanation}`;
            feedbackElement.appendChild(explanationElement);
            feedbackElement.style.display = 'block';
        }

        function renderPaginationControls() {
            paginationControlsElement.innerHTML = '';
            const numPages = Math.ceil(questions.length / questionsPerPage);

            const prevButton = document.createElement('button');
            prevButton.textContent = '이전';
            prevButton.disabled = currentPage === 0;
            prevButton.onclick = () => renderQuestionsForPage(currentPage - 1);
            paginationControlsElement.appendChild(prevButton);

            for (let i = 0; i < numPages; i++) {
                const pageButton = document.createElement('button');
                pageButton.textContent = i + 1;
                pageButton.classList.add('page-number');
                if (i === currentPage) {
                    pageButton.classList.add('current');
                }
                pageButton.onclick = () => renderQuestionsForPage(i);
                paginationControlsElement.appendChild(pageButton);
            }

            const nextButton = document.createElement('button');
            nextButton.textContent = '다음';
            nextButton.disabled = currentPage === numPages - 1;
            nextButton.onclick = () => renderQuestionsForPage(currentPage + 1);
            paginationControlsElement.appendChild(nextButton);
        }

        function showMotivationalQuote() {
            const randomIndex = Math.floor(Math.random() * motivationalQuotes.length);
            motivationalQuoteElement.textContent = motivationalQuotes[randomIndex];
            motivationalQuoteElement.style.display = 'block';
        }

        submitPageButton.addEventListener('click', () => {
            if (pageAttempted[currentPage]) return;

            let scoreForThisPage = 0;
            
            const start = currentPage * questionsPerPage;
            const end = Math.min(start + questionsPerPage, questions.length);
            const questionsOnPage = questions.slice(start, end);

            questionsOnPage.forEach((q, indexOnPage) => {
                const questionCard = quizElement.children[indexOnPage];
                const selectedOptionInput = questionCard.querySelector(`input[name="question-${q.id}"]:checked`);
                
                q.attemptedThisSession = true;

                if (selectedOptionInput) {
                    q.userAnswer = selectedOptionInput.value;
                    q.isCorrect = (q.userAnswer === q.answer);
                    
                    if (q.isCorrect) {
                        scoreForThisPage++;
                    }
                    showFeedbackForQuestion(q, questionCard);

                    const radioInputs = questionCard.querySelectorAll('input[type="radio"]');
                    radioInputs.forEach(input => input.disabled = true);
                } else {
                    const feedbackElement = questionCard.querySelector('.feedback');
                    feedbackElement.textContent = '답을 선택하지 않았습니다.';
                    feedbackElement.className = 'feedback incorrect';
                    feedbackElement.style.display = 'block';
                    q.isCorrect = false;
                }
            });
            
            pageScores[currentPage] = scoreForThisPage;
            pageAttempted[currentPage] = true;
            submitPageButton.disabled = true;
            submitPageButton.textContent = '채점 완료';
            
            scoreSectionElement.style.display = 'block';
            updateScoreDisplay();
            showMotivationalQuote();

            const quizContainerElement = document.querySelector('.quiz-container');
            if (quizContainerElement) {
                quizContainerElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        });

        function updateScoreDisplay() {
            const questionsOnThisPageCount = Math.min(questionsPerPage, questions.length - (currentPage * questionsPerPage));
            currentPageScoreTextElement.textContent = `이번 페이지 점수: ${pageScores[currentPage]} / ${questionsOnThisPageCount}`;
            
            let currentTotalScore = 0;
            let currentTotalAttemptedQuestions = 0;
            for(let i=0; i < pageAttempted.length; i++){
                if(pageAttempted[i]){
                    const start = i * questionsPerPage;
                    const end = Math.min(start + questionsPerPage, questions.length);
                    currentTotalAttemptedQuestions += (end-start);
                    currentTotalScore += pageScores[i];
                }
            }

            const quizTitleElement = document.querySelector('h1');
            let quizMainTitle = "현재 단원";
            if (quizTitleElement) {
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = quizTitleElement.innerHTML;
                quizMainTitle = tempDiv.textContent || tempDiv.innerText || "";
                const titleParts = quizMainTitle.split('(');
                if (titleParts.length > 0) {
                    quizMainTitle = titleParts[0].trim();
                }
            }
            
            if (quizMainTitleDisplayElement) {
                quizMainTitleDisplayElement.textContent = quizMainTitle;
            }

            if (currentTotalAttemptedQuestions > 0) {
                 totalScoreTextElement.style.display = 'block';
                 totalScoreTextElement.textContent = `총 누적 점수: ${currentTotalScore} / ${currentTotalAttemptedQuestions}`;
            } else {
                 totalScoreTextElement.style.display = 'none';
            }
        }
        
        // 팝업 기능
        window.onload = () => {
            if (welcomePopup) {
                // 각 퀴즈 페이지마다 고유한 sessionStorage 키 사용
                const popupSessionKey = 'appiaQuizPasswordEntered_physics1_final_part2_v3';
                const popupShownThisSession = sessionStorage.getItem(popupSessionKey);
                if (!popupShownThisSession) {
                    welcomePopup.classList.add('show');
                } else {
                    initializeQuizData();
                    renderQuestionsForPage(0);
                }
            } else {
                initializeQuizData();
                renderQuestionsForPage(0);
            }
        };

        if (popupConfirmButton) {
            popupConfirmButton.addEventListener('click', () => {
                if (popupPasswordInput.value === correctPassword) {
                    if (welcomePopup) {
                        welcomePopup.classList.remove('show');
                    }
                    const popupSessionKey = 'appiaQuizPasswordEntered_physics1_final_part2_v3';
                    sessionStorage.setItem(popupSessionKey, 'true');
                    initializeQuizData();
                    renderQuestionsForPage(0);
                } else {
                    if (popupErrorMessage) {
                        popupErrorMessage.textContent = "비밀번호가 틀렸습니다. 다시 시도해주세요.";
                    }
                    popupPasswordInput.value = '';
                    popupPasswordInput.focus();
                }
            });
        }
        
        if (popupPasswordInput) {
            popupPasswordInput.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    popupConfirmButton.click();
                }
            });
        }

    </script>
</body>
</html>
